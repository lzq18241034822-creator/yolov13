先把你的两个核心问题说清楚，然后给你“从头到尾”的10步落地清单（纯文字，无代码）。

一、先回答你的两个问题
1) TXT 标注文件需不需要更改？
- 不需要改。你当前格式“每行= 5个ID + 多边形分割点（归一化）+ 头部5行元数据”完全符合 µSHM‑YOLO 的训练与推理要求。
- 不能因为“有超图”就去掉分割点。原因：
  - 分割是实例级监督的核心信号，直接决定 mask 质量，不能用超图替代；
  - 超图依赖于实例之间的空间关系、接触关系等，最好来自掩膜（touch bonus、邻接/相似度）而非仅仅bbox；
  - 你要做形态测量（面积、周长、长短轴、紧致度、椭圆IoU），没有分割点/掩膜就无法在物理单位（µm/µm²）下精确计算；
  - 几何一致性监督（论文创新点之一）也需要掩膜几何量的真值。
- 小结：保持你现在的TXT结构不变（5ID + polygon），训练时在线由 polygon 计算bbox即可。

2) YAML 需不需要更改？
- 不需要改。你把命名改为 {image_stem}.txt（不带前缀），只要TXT头部包含像素尺度等元数据，µScale与度量换算都能从头部取到，这样也更简明。
- 你的类别定义、cell_org 四类（7/8/9/44，兼容10/11映射到44）、Mask2Morph各head num_classes、规则引擎、几何参数清单都已与方案对齐。
- 仅1点温馨建议（非必改）：规则里“衣藻（species=1）required.flagella=[23,24,25]”把3鞭毛也列为必选之一，这在生物学上不常见。如果你的数据确实有3鞭毛衣藻样本，这样设没问题；若没有，建议把25从required里移除，转到“允许变体/软约束”即可，避免训练期被过强约束。

二、从头到尾的10步实施清单（基于你现有YOLOv13仓库+超图）
每步包含：做什么/改哪里/产出与通过标准/注意点。严格按序推进，训练会更稳。

步骤1｜数据一致性与质检闭环
- 做什么：用你现有TXT（5ID+polygon+头部），跑一轮严格质检与统计，确保无硬错误，给出分布报告。
- 改哪里：工具脚本层（质检：文件名↔头部一致、坐标归一化、偶数点、ID范围、polygon→bbox可用；统计：各头样本数，小目标占比）。
- 产出与通过：err=0，summary.csv 正常；随机抽样可视化叠加 polygon；确保 pixel_dimensions_px 与实际图像尺寸一致。
- 注意点：旧10/11在训练中映射到44；头部 pixel_size_um 必须存在、数值与显微镜设置一致。

步骤2｜统一格式数据加载（Stage1，polygon→在线bbox）
- 做什么：在你YOLOv13的数据层新增“统一格式”解析器，读取TXT头部与行，polygon在线转bbox，species∈{40,41,42,43}行跳过。
- 改哪里：datasets 模块新增统一加载器；batch除imgs/labels/segments外，还要返回 pixel_size_um（供 µScale）。
- 产出与通过：单batch sanity check打印；把polygon在原图上叠加；bbox能包住polygon；pixel_size_um随图返回。
- 注意点：所有增强（仿射/缩放/翻转）必须同步作用到segments，否则mask监督会错位。

步骤3｜Stage1分割基线训练（先不打开属性/超图/µScale）
- 做什么：先把“检测+分割”打稳，验证链路端到端OK。
- 改哪里：训练配置（epochs=100~150先验环、mosaic低、mixup关、旋转≤25°、轻噪声/轻模糊），日志与可视化。
- 产出与通过：mAP50(M)≈75–82%，小目标召回≥55%；导出若干可视化图（原图+mask叠加）。
- 注意点：这一步只训单类分割（cls=0），忽略5ID。

步骤4｜µScale像素尺度注入（FiLM）
- 做什么：引入 µm/px 的FiLM调制，提升跨批次/跨仪器的一致性（即使现在全数据同尺度，也为后续扩展打地基）。
- 改哪里：在backbone.s3/s4与neck.p3/p2加入FiLM通路（gamma/beta）；训练/推理传入 pixel_size_um（log归一化）。
- 产出与通过：与步骤3对比：整体mAP↑0.5~1.5%，小目标AP与面积误差更稳；跨不同采集批的指标方差下降。
- 注意点：保留默认像素尺度（0.0863）作为fallback；训练日志记录pixel_size_um。

步骤5｜小目标结构强化（P2+RepGFPN+DCNv3）
- 做什么：专攻微小藻体的召回与边界质量。
- 改哪里：你YOLOv13已有这些模块，确保训练时启用P2输出、RepGFPN训练态多分支/推理态重参数，Backbone S3/S4替换为DCNv3（若已接入则只需开关）。
- 产出与通过：mAP50(M)+3~5%，APS（小目标AP）+10~15%；推理速度下降<10%。
- 注意点：若显存压力大，可降低P2通道/采样点；DCNv3若未来部署困难，可保留训练、导出时提供降级版本。

步骤6｜接入Mask2Morph一体化五属性头（先用GT ROI）
- 做什么：在分割后对实例做多尺度ROI-Align→Transformer解码器→5个head（species 45类；cell_org 4类；shape 10；flagella 5；chloroplast 4）。
- 改哪里：模型head模块新增 Mask2Morph；训练阶段先用GT ROI；标签映射对齐YAML（cell_org: 7/8/9/44→0/1/2/3；10/11映射到3）。
- 产出与通过：在不明显牺牲分割的前提下，5头Acc达到基线（species 88–92%、cell_org 85–90%、flagella 90–95%）。
- 注意点：先冻结属性头以免不稳→再解冻联合；再逐步混入一部分“预测ROI”增加鲁棒性。

步骤7｜两段式轻量分类器蒸馏（仅训练期）
- 做什么：训练轻量ROI分类器作为Teacher，对Mask2Morph的5个head进行KL蒸馏（小权重），提升长尾稳定性。
- 改哪里：导出ROI→训练Teacher→联合训练时在5个head加入蒸馏项（起初权重大，后期降低）。
- 产出与通过：5头平均Acc提升1–2%，长尾类别收敛更稳；最终推理不需要Teacher。
- 注意点：Teacher使用相同的标签映射；Teacher soft targets的温度可>1改善信息量。

步骤8｜整合超图模块（只强化 cell_organization）
- 做什么：利用你YOLOv13已有超图功能，对同一视野内实例构图（kNN+半径+接触加权），输出一个“图分支”的cell_org logits，与Mask2Morph的cell_org head融合。
- 改哪里：在超图模块中明确：构图特征（中心距/方向/相似度/接触度）、节点/边上限、pair/quartet超边候选；训练时加入两流一致性损失；推理时采用置信加权融合。
- 产出与通过：cell_org（单/双/四/多）准确率从~85%→90–93%；pair/quartet召回显著提升。
- 注意点：只对高置信实例构图；密集图像限制max_nodes/k，防止算子爆。

步骤9｜软规则正则（训练）+ 冲突降级（推理）
- 做什么：
  - 训练期：把YAML规则转为可微惩罚（门控：species_conf>0.7时生效；分阶段加权），减少不合理组合；
  - 推理期（你指定策略）：一旦“物种+属性”触犯硬规则，就把物种降级为对应“疑似类”（0→31,1→32,2→33,3→34,4→35,5→36,6→37），属性不改并记录冲突原因。
- 改哪里：loss模块增加软规则正则；推理整合处实现“检查→降级→记录”流程。
- 产出与通过：冲突率<2%；降级样例在JSON标注 raw_species vs final_species，并附 violations 列表。
- 注意点：避免把“罕见但合理”的变体当作违例（放在allowed_variations或软约束即可）。

步骤10｜几何参数双重监督与形态测量（物理单位输出）
- 做什么：以掩膜几何量（换算为µm/µm²）作为回归目标与一致性损失（Smooth‑L1），提升边界与测量稳定性；推理时计算10个参数并写单位。
- 改哪里：新增几何回归头（基于实例特征）；推理参数计算模块（面积/周长/长短轴/紧致度/椭圆IoU/聚集度/一致性等）。
- 产出与通过：面积MAE<5%、周长MAE<8%、长短轴MAE<10%、R²>0.95；JSON含 pixel_size_um 与单位。
- 注意点：对极小掩膜启用最小面积门槛，避免长轴/周长不稳定；异常差异（回归 vs 公式）>20%时标记需复核。

三、创新点是否足够发好文章？
- 足够。你的方案在“任务层面与工程落地”双线创新，亮点很集中：
  - µScale像素尺度注入（物理量感知）
  - Mask2Morph一体化（检测-分割-五属性同源学习）
  - 超图增强群体判别（单/双/四/多>4）
  - 软规则正则+推理降级为疑似（知识注入与风险控制）
  - 几何双监督（物理单位的一致性监督）
  - 小目标结构（P2/RepGFPN/DCNv3）+ 显微场景增强策略
- 如需锦上添花（可选，不是必须）：
  - 不确定性校准（温度缩放/Dirichlet）附在疑似降级上，给出置信门槛的校准曲线；
  - 半监督小规模扩展（用高置信伪标签 + 几何一致性筛选）提升长尾类。

四、小结与你当前状态
- 你的TXT与YAML都不需要改；保持“5ID + polygon + 头部”的格式；
- 下一步就按“加载器→分割基线→µScale+小目标→一体化→超图→软规则→几何→推理整合”的顺序推进；
- 你已经把“多细胞(>4)=44”加好了；推理冲突时的“降级到疑似类”也纳入了最终策略，论文里可以作为“可信推理”的一部分重点写。

准备好后，我就给你“统一格式dataloader + 同步几何增强的接线说明”（只给这一块的实现要点），你在你yolov13仓库里先跑通步骤2–3。你现在想先落地哪一步，我就把那一步细化到可执行清单（不写具体代码，按模块/函数/配置讲清楚）。